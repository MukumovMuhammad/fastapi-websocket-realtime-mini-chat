<!DOCTYPE html>
<html>
<head>
    <title>FastAPI Chat</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>

<div class="container mt-4">

    <h1 class="text-center">FastAPI WebSocket Chat</h1>

    <!-- SIGN IN / SIGN UP -->
    <div id="auth_div" class="mt-4">
        <div id="sign_in_div" class=""></div>
        <form id="signin_form">
            <input type="text" class="form-control mt-2" id="username_inp" placeholder="Username">
            <input type="password" class="form-control mt-2" id="password_inp" placeholder="Password">
            <button class="btn btn-primary mt-3" onclick="signin(event)">Sign In</button>
            <button class="btn btn-success mt-3" onclick="signup(event)">Sign Up</button>
        </form>


    </div>
<!-- 
            //CHAT ROOM// 
    <div id="chat_room" class="d-none mt-4">
        <h3>Chat Room</h3>
        <p>Your User ID: <span id="user_id"></span></p>

        <ul id="messages"></ul>

        <form>
            <input type="text" id="messageText" class="form-control" placeholder="Message..." autocomplete="off">
            <button class="btn btn-outline-primary mt-2" onclick="sendMessage(event)">Send</button>
        </form>
    </div> -->

</div>


<script>

    //------------------------------------------
    // SIGN UP
    //------------------------------------------
    async function signup(event) {
        event.preventDefault();

        const username = document.getElementById("username_inp").value;
        const password = document.getElementById("password_inp").value;

        const res = await fetch("/sign_up", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({username, password})
        });

        if (res.ok) {
            const data = await res.json();
            alert(data.message);
            console.log(data)
            username.value = ""
            password.value = ""
           
        } else {
            alert("Error creating account.");
        }
    }
    //------------------------------------------
    // SIGN IN
    //------------------------------------------
    async function signin(event) {
        event.preventDefault();

        const username = document.getElementById("username_inp").value;
        const password = document.getElementById("password_inp").value;

        const res = await fetch("/login", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({username, password})
        });

        if (res.ok) {
            const data = await res.json();
            alert(data.message);
            console.log(data)
            username.value = ""
            password.value = ""
           
        } else {
            alert("Error while loging account.");
        }

        // document.getElementById("auth_div").classList.add("d-none");
        // document.getElementById("chat_room").classList.remove("d-none");
        // document.getElementById("user_id").textContent = currentUserId;

        // openWebSocket();
    }




</script>

</body>
</html>
